import{b as S,r as i,j as e,H as D,a as v}from"./app-F9mGVywk.js";import{N as E}from"./NavBar-BRLkNves.js";import{C as F}from"./Container-Cdm_3uio.js";const k="_modalOverlay_1s68n_1",B="_modalDialogCentered_1s68n_11",M="_editModal_1s68n_18",$="_modalHeader_1s68n_27",X="_closeBtn_1s68n_37",U="_modalBody_1s68n_45",H="_fileUpload_1s68n_70",O="_uploadBtn_1s68n_77",L="_fileName_1s68n_86",T="_modalFooter_1s68n_91",l={modalOverlay:k,modalDialogCentered:B,editModal:M,modalHeader:$,closeBtn:X,modalBody:U,fileUpload:H,uploadBtn:O,fileName:L,modalFooter:T},G=()=>{const{user:r,requests:u=[]}=S().props,[w,m]=i.useState(!1),[n,h]=i.useState({name:r.name,phone:r.phone,email:r.email,profilePhoto:null,osra_code:""}),[f,g]=i.useState(""),[o,b]=i.useState({}),[y,p]=i.useState(!1),[t,N]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[d,_]=i.useState({}),x=a=>{a.target.name==="profilePhoto"?h({...n,profilePhoto:a.target.files[0]}):h({...n,[a.target.name]:a.target.value})},P=a=>{a.preventDefault();const s=new FormData;s.append("full_name",n.name),s.append("email",n.email),s.append("mobile",n.phone),n.profilePhoto&&s.append("user_photo",n.profilePhoto),n.osra_code&&s.append("osra_code",n.osra_code),v.post(route("profile.update"),s,{forceFormData:!0,onSuccess:()=>{b({}),m(!1)},onError:c=>{b(c)}})},j=a=>{N({...t,[a.target.name]:a.target.value})},C=a=>{a.preventDefault();const s=new FormData;s.append("current_password",t.currentPassword),s.append("new_password",t.newPassword),s.append("new_password_confirmation",t.confirmPassword),v.post(route("password.change"),s,{forceFormData:!0,onSuccess:()=>{N({currentPassword:"",newPassword:"",confirmPassword:""}),_({}),p(!1)},onError:c=>{_(c)}})};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Ù…Ø±ÙƒØ² ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ø¥ÙŠØ¶Ø§Ø­"}),e.jsx(E,{page_name:"profile"}),e.jsx(F,{children:e.jsxs("div",{className:"row mt-4 g-4",children:[e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card shadow-sm text-center p-4",children:[e.jsx("img",{src:r.profilePhoto,className:"rounded-circle mx-auto w-32 h-32 object-cover",alt:"Profile"}),e.jsx("h5",{className:"mb-1",children:r.name}),e.jsx("p",{className:"text-muted mb-0",children:r.email}),e.jsx("p",{className:"text-muted mt-0",children:r.phone}),e.jsx("div",{className:"profile-osra mt-3 p-3 border rounded bg-light text-start mb-4",children:r.osra?e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:"mb-2",children:"ðŸ§‘â€ðŸ‘©â€ðŸ‘§ Family Details"}),e.jsxs("div",{className:"d-flex flex-column gap-1",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Name:"})," ",r.osra.osra_name]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Place:"})," ",r.osra.osra_place]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Time:"})," ",r.osra.osra_time]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Code:"})," ",e.jsx("span",{className:"badge bg-primary",children:r.osra.osra_code})]})]})]}):e.jsx("p",{className:"text-muted mb-0",children:"No Family assigned"})}),e.jsx("button",{className:"btn btn-outline-primary w-100 mb-2",onClick:()=>m(!0),children:"Edit Profile"}),e.jsx("button",{className:"btn btn-primary w-100",onClick:()=>p(!0),children:"Change Password"})]})}),e.jsxs("div",{className:"col-12 col-md-8",children:[e.jsx("h5",{className:"mb-3",children:"Latest Requests"}),u.length===0&&e.jsx("div",{className:"alert alert-info",children:"No requests yet."}),u.map((a,s)=>e.jsx("div",{className:"card shadow-sm mb-3",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("strong",{children:["Request #",++s]}),e.jsx("span",{className:`badge ${a.request_status==="accepted"?"bg-success":a.request_status==="pending"?"bg-warning text-dark":a.request_status==="done"?"bg-danger":"bg-secondary"}`,children:a.request_status})]}),e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"badge bg-primary",children:a.osra_name??a.osra_code})}),e.jsxs("div",{className:"mb-2 text-muted small",children:[a.start_date&&a.start_time?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Start:"})," ",new Date(a.start_date+"T"+a.start_time).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]}):a.osra_time&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Time:"})," ",a.osra_time]}),e.jsx("br",{}),a.end_date&&a.end_time&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"End:"})," ",new Date(a.end_date+"T"+a.end_time).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"text-muted small",children:[e.jsx("strong",{children:"Ordered at:"})," ",new Date(a.created_at).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})},a.request_id))]})]})}),w&&e.jsx("div",{className:l.modalOverlay,children:e.jsx("div",{className:l.modalDialogCentered,children:e.jsx("div",{className:l.editModal,children:e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{className:l.modalHeader,children:[e.jsx("h3",{className:"modal-title",children:"Edit Profile"}),e.jsx("button",{type:"button",className:`${l.closeBtn} fs-2`,onClick:()=>m(!1),children:"Ã—"})]}),e.jsxs("div",{className:l.modalBody,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Full Name"}),e.jsx("input",{type:"text",name:"name",value:n.name,onChange:x,className:`form-control ${o.name?"is-invalid":""}`}),o.name&&e.jsx("div",{className:"invalid-feedback",children:o.name})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:n.email,onChange:x,className:`form-control ${o.email?"is-invalid":""}`}),o.email&&e.jsx("div",{className:"invalid-feedback",children:o.email})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Mobile"}),e.jsx("input",{type:"tel",name:"phone",value:n.phone,onChange:a=>{const s=a.target.value.replace(/[^0-9]/g,"");h({...n,phone:s})},className:`form-control ${o.phone?"is-invalid":""}`,placeholder:"01XXXXXXXXX",inputMode:"numeric",maxLength:11}),o.phone&&e.jsx("div",{className:"invalid-feedback",children:o.phone})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Family Code"}),e.jsx("input",{type:"text",name:"osra_code",value:n.osra_code,onChange:x,className:`form-control ${o.osra_code?"is-invalid":""}`,placeholder:"Enter family code"}),o.osra_code&&e.jsx("div",{className:"invalid-feedback",children:o.osra_code})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Profile Photo"}),e.jsxs("div",{className:l.fileUpload,children:[e.jsxs("label",{className:`${l.uploadBtn} mt-0`,children:["Upload Photo",e.jsx("input",{type:"file",name:"profilePhoto",hidden:!0,onChange:a=>{const s=a.target.files[0];s&&(h(c=>({...c,profilePhoto:s})),g(s.name))}})]}),f&&e.jsx("span",{className:l.fileName,children:f})]}),o.profilePhoto&&e.jsx("div",{className:"invalid-feedback d-block",children:o.profilePhoto})]})]}),e.jsxs("div",{className:l.modalFooter,children:[e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>m(!1),children:"Cancel"})]})]})})})}),y&&e.jsx("div",{className:l.modalOverlay,children:e.jsx("div",{className:l.modalDialogCentered,children:e.jsx("div",{className:l.editModal,children:e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:l.modalHeader,children:[e.jsx("h3",{className:"modal-title",children:"Change Password"}),e.jsx("button",{type:"button",className:`${l.closeBtn} fs-2`,onClick:()=>p(!1),children:"Ã—"})]}),e.jsxs("div",{className:l.modalBody,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Current Password"}),e.jsx("input",{type:"password",name:"currentPassword",value:t.currentPassword,onChange:j,className:`form-control ${d.current_password?"is-invalid":""}`}),d.current_password&&e.jsx("div",{className:"invalid-feedback",children:d.current_password})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",name:"newPassword",value:t.newPassword,onChange:j,className:`form-control ${d.new_password?"is-invalid":""}`}),d.new_password&&e.jsx("div",{className:"invalid-feedback",children:d.new_password})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",name:"confirmPassword",value:t.confirmPassword,onChange:j,className:`form-control ${d.new_password_confirmation?"is-invalid":""}`}),d.new_password_confirmation&&e.jsx("div",{className:"invalid-feedback",children:d.new_password_confirmation})]})]}),e.jsxs("div",{className:l.modalFooter,children:[e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>p(!1),children:"Cancel"})]})]})})})})]})};export{G as default};
