import{b as _,j as e,a as b,r as n,H as E}from"./app-F9mGVywk.js";import{N as A}from"./NavBar-BRLkNves.js";import{C as M}from"./Container-Cdm_3uio.js";import{d as F}from"./index-CrJ5_I2Q.js";import{s as j}from"./AddModal.module-DtOpv7EN.js";import{s as y,a as N}from"./DeleteModal.module-BRf8I1mm.js";const P=({id:t,title:a,description:d,image:m,onEdit:l,onDelete:i})=>{const{auth:u}=_().props,f=u.user?.user_type==="manager",h=()=>{b.visit(route("categories.show",t))};return e.jsxs("div",{className:"rounded-xl overflow-hidden shadow-md hover:shadow-lg transition-shadow hover:scale-105 bg-white cursor-pointer",children:[e.jsx("img",{src:m,className:"w-full object-cover aspect-[4/3] max-h-32 sm:max-h-none",alt:a,onClick:h}),e.jsxs("div",{className:"p-4 sm:p-3 text-center",children:[e.jsxs("div",{onClick:h,children:[e.jsx("h5",{className:"text-lg sm:text-base font-bold mb-2 text-gray-800",children:a}),e.jsx("p",{className:"text-sm sm:text-xs text-gray-600",children:d})]}),f?e.jsxs("div",{className:"mt-2.5 flex gap-1 justify-center",children:[e.jsx("button",{className:"btn btn-primary btn-sm",onClick:c=>{c.stopPropagation(),l()},children:"Edit"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:c=>{c.stopPropagation(),i()},children:"Delete"})]}):null]})]})},B=({id:t,title:a,description:d,image:m,isSelected:l,selectable:i,onEdit:u,onDelete:p})=>e.jsx("div",{className:`cursor-pointer rounded ${i?l?"border-2 border-blue-600":"border-2 border-dashed border-transparent":"border-none"} ${i?"p-1":""}`,children:e.jsx(P,{id:t,image:m,title:a,description:d,onEdit:u,onDelete:p})}),$=({onClose:t})=>{const[a,d]=n.useState(""),[m,l]=n.useState(""),[i,u]=n.useState(null),[p,f]=n.useState(""),[h,c]=n.useState(!1),x=()=>{if(!a||!m||!i)return alert("All fields are required!");const o=new FormData;o.append("category_name",a),o.append("category_description",m),o.append("category_photo",i),c(!0),F.Inertia.post(route("categories.store"),o,{onSuccess:()=>{c(!1),t()},onError:()=>c(!1)})};return e.jsx("div",{className:j.modalOverlay,children:e.jsxs("div",{className:j.addModal,children:[e.jsxs("div",{className:j.modalHeader,children:[e.jsx("h3",{children:"Add Category"}),e.jsx("button",{className:`${j.closeBtn} fs-2`,onClick:t,children:"×"})]}),e.jsxs("div",{className:j.modalBody,children:[e.jsx("label",{children:"Category Name"}),e.jsx("input",{value:a,onChange:o=>d(o.target.value)}),e.jsx("label",{children:"Category Description"}),e.jsx("textarea",{value:m,onChange:o=>l(o.target.value)}),e.jsxs("div",{className:j.fileUpload,children:[e.jsxs("label",{className:j.uploadBtn,children:["Upload Photo",e.jsx("input",{type:"file",hidden:!0,onChange:o=>{u(o.target.files[0]),f(o.target.files[0].name)}})]}),p&&e.jsx("span",{className:j.fileName,children:p})]})]}),e.jsxs("div",{className:j.modalFooter,children:[e.jsx("button",{className:"btn btn-success",onClick:x,disabled:h,children:h?"Adding...":"Add Category"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:t,children:"Cancel"})]})]})})},H=({category:t,onClose:a})=>{const[d,m]=n.useState(t.category_name||""),[l,i]=n.useState(t.category_description||""),[u,p]=n.useState(null),[f,h]=n.useState(""),[c,x]=n.useState(!1),o=()=>{const r=new FormData;r.append("category_name",d),r.append("category_description",l),u&&r.append("category_photo",u),r.append("_method","put"),x(!0),b.post(route("categories.update",t.category_id),r,{forceFormData:!0,onSuccess:()=>{x(!1),a()},onError:()=>x(!1)})};return e.jsx("div",{className:y.modalOverlay,children:e.jsxs("div",{className:y.editModal,children:[e.jsxs("div",{className:y.modalHeader,children:[e.jsx("h3",{children:"Edit Category"}),e.jsx("button",{className:`${y.closeBtn} fs-2`,onClick:a,children:"×"})]}),e.jsxs("div",{className:y.modalBody,children:[e.jsx("label",{children:"Category Name"}),e.jsx("input",{value:d,onChange:r=>m(r.target.value)}),e.jsx("label",{children:"Category Description"}),e.jsx("textarea",{value:l,onChange:r=>i(r.target.value)}),e.jsxs("div",{className:y.fileUpload,children:[e.jsxs("label",{className:y.uploadBtn,children:["Upload Photo",e.jsx("input",{type:"file",hidden:!0,onChange:r=>{p(r.target.files[0]),h(r.target.files[0].name)}})]}),f&&e.jsx("span",{className:y.fileName,children:f})]})]}),e.jsxs("div",{className:y.modalFooter,children:[e.jsx("button",{className:"btn btn-primary",onClick:o,disabled:c,children:c?"Saving...":"Save Changes"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:a,children:"Cancel"})]})]})})},U=({categoryName:t,onConfirm:a,onClose:d})=>e.jsx("div",{className:N.modalOverlay,children:e.jsxs("div",{className:N.redModal,children:[e.jsxs("div",{className:N.modalHeader,children:[e.jsx("h3",{children:"Delete Category"}),e.jsx("button",{className:`${N.closeBtn} fs-2`,onClick:d,children:"×"})]}),e.jsx("div",{className:N.modalBody,children:e.jsxs("p",{children:['Are you sure you want to delete "',e.jsx("strong",{children:t}),'" and all its items?']})}),e.jsxs("div",{className:N.modalFooter,children:[e.jsx("button",{className:"btn btn-danger",onClick:a,children:"Delete"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:d,children:"Cancel"})]})]})}),G=()=>{const{categories:t}=_().props,{auth:a}=_().props,m=a.user?.user_type==="manager",[l,i]=n.useState(null),[u,p]=n.useState(!1),[f,h]=n.useState(!1),[c,x]=n.useState(!1),o=()=>p(!0),r=s=>{i(s),h(!0)},D=s=>{i(s),x(!0)},S=({name:s,description:v,photo:C})=>{const g=new FormData;g.append("category_name",s),g.append("category_description",v),C&&g.append("category_photo",C),b.post(route("categories.store"),g,{headers:{"Content-Type":"multipart/form-data"}}),p(!1)},w=({name:s,description:v,photo:C})=>{const g=new FormData;g.append("category_name",s),g.append("category_description",v),C&&g.append("category_photo",C),g.append("_method","PATCH"),b.post(route("categories.update",l.category_id),g,{headers:{"Content-Type":"multipart/form-data"}}),h(!1)},k=()=>{b.delete(route("categories.destroy",l.category_id)),x(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"مركز وسائل الإيضاح"}),e.jsx(A,{page_name:"categories"}),e.jsxs(M,{children:[e.jsx("h2",{className:"mt-6",children:"Categories"}),m?e.jsx("div",{className:"mt-4 mb-8 flex gap-2.5",children:e.jsx("button",{className:"btn btn-success",onClick:o,children:"Add Category"})}):null,e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:t.map(s=>e.jsx("div",{children:e.jsx(B,{id:s.category_id,title:s.category_name,description:s.category_description,image:s.category_photo?`storage/${s.category_photo}`:"/imgs/shopping.webp",onEdit:()=>r(s),onDelete:()=>D(s)},s.category_id)},s.category_id))}),u&&e.jsx($,{onClose:()=>p(!1),onConfirm:S}),f&&e.jsx(H,{onClose:()=>h(!1),category:l,onConfirm:w}),c&&e.jsx(U,{onClose:()=>x(!1),onConfirm:k,categoryName:l?.category_name})]})]})};export{G as default};
