import{g as H,r as l,j as e,d as W,b as k,a as P,H as L}from"./app-F9mGVywk.js";import{N as V}from"./NavBar-BRLkNves.js";import{I as Y}from"./Item-pack-gLaeGapb.js";import{C as G}from"./Container-Cdm_3uio.js";import{s as v}from"./index-ikzcNs2d.js";import{T as Q}from"./TopAlert-B9UA6XVE.js";import{E as J,D as K}from"./DeleteItemModal-IYLP5zNS.js";import"./index-DVAfsfYP.js";import"./DeleteModal.module-BRf8I1mm.js";var S={exports:{}},w,F;function X(){if(F)return w;F=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return w=s,w}var C,z;function Z(){if(z)return C;z=1;var s=X();function d(){}function c(){}return c.resetWarningCache=d,C=function(){function t(o,m,i,p,x,y){if(y!==s){var j=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw j.name="Invariant Violation",j}}t.isRequired=t;function r(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:c,resetWarningCache:d};return n.PropTypes=n,n},C}var R;function ee(){return R||(R=1,S.exports=Z()()),S.exports}var se=ee();const te=H(se),ae="_modalOverlay_1cc0n_1",oe="_greenModal_1cc0n_16",re="_modalHeader_1cc0n_27",le="_closeBtn_1cc0n_38",ne="_modalBody_1cc0n_46",ce="_uploadBtn_1cc0n_52",de="_modalFooter_1cc0n_63",b={modalOverlay:ae,greenModal:oe,modalHeader:re,closeBtn:le,modalBody:ne,uploadBtn:ce,modalFooter:de},ie=({product:s,onClose:d,onUploaded:c})=>{const[t,r]=l.useState(null),[n,o]=l.useState(!1),m=async i=>{if(i.preventDefault(),!t)return alert("Please select a photo!");const p=new FormData;p.append("photo",t),p.append("product_id",s.product_id),p.append("_token",document.querySelector('meta[name="csrf-token"]').content);try{o(!0),await W.post(v("products.upload_image"),p,{headers:{"Content-Type":"multipart/form-data"}}),o(!1),c?.(),d()}catch(x){o(!1),console.error(x),alert("Upload failed!")}};return e.jsx("div",{className:b.modalOverlay,children:e.jsxs("div",{className:b.greenModal,children:[e.jsxs("div",{className:b.modalHeader,children:[e.jsx("h3",{children:"Upload Photo"}),e.jsx("button",{className:`${b.closeBtn} fs-2`,onClick:d,children:"×"})]}),e.jsx("div",{className:b.modalBody,children:e.jsxs("form",{onSubmit:m,children:[e.jsxs("label",{className:b.uploadBtn,children:[t?t.name:"Choose Photo",e.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:i=>r(i.target.files[0]),required:!0})]}),e.jsxs("div",{className:b.modalFooter,children:[e.jsx("button",{type:"submit",className:"btn btn-success",disabled:n,children:n?"Uploading...":"Upload"}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:d,disabled:n,children:"Close"})]})]})})]})})},me="_modalOverlay_1je2w_1",pe="_greenModal_1je2w_16",ue="_modalHeader_1je2w_27",he="_closeBtn_1je2w_38",xe="_modalBody_1je2w_46",be="_colorInput_1je2w_71",fe="_modalFooter_1je2w_79",f={modalOverlay:me,greenModal:pe,modalHeader:ue,closeBtn:he,modalBody:xe,colorInput:be,modalFooter:fe},je=({type:s,productId:d,onClose:c})=>{const[t,r]=l.useState(s==="color"?"#000000":""),n={material:v("products.add-material"),color:v("products.add-color"),size:v("products.add-size")};return e.jsx("div",{className:f.modalOverlay,children:e.jsxs("div",{className:f.greenModal,children:[e.jsxs("div",{className:f.modalHeader,children:[e.jsxs("h3",{children:["Add ",s.charAt(0).toUpperCase()+s.slice(1)]}),e.jsx("button",{className:`${f.closeBtn} fs-2`,onClick:c,children:"×"})]}),e.jsx("div",{className:f.modalBody,children:e.jsxs("form",{action:n[s],method:"POST",encType:"multipart/form-data",children:[e.jsx("input",{type:"hidden",name:"_token",value:document.querySelector('meta[name="csrf-token"]').content}),e.jsx("input",{type:"hidden",name:"product_id",value:d}),s==="color"?e.jsx("input",{type:"color",name:"value",value:t,onChange:o=>r(o.target.value),className:f.colorInput,required:!0}):e.jsx("input",{type:"text",name:"value",value:t,placeholder:`Enter ${s}`,onChange:o=>r(o.target.value),required:!0}),e.jsxs("div",{className:f.modalFooter,children:[e.jsx("button",{type:"submit",className:"btn btn-success",children:"Add"}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:c,children:"Close"})]})]})})]})})};function $({product:s}){const{auth:d,flash:c,cartItems:t=[]}=k().props||{},[r,n]=l.useState(0),[o,m]=l.useState(1),[i,p]=l.useState(""),[x,y]=l.useState(""),[j,u]=l.useState(""),[A,T]=l.useState(!1),[M,_]=l.useState({show:!1,type:""}),I=d.user,q=I?.user_type==="manager",[D,g]=l.useState(""),[O,B]=l.useState(!1);l.useEffect(()=>{t?.includes(s.product_id)&&B(!0)},[t,s.product_id]),l.useEffect(()=>{c?.success&&g(c.success)},[c]);const E=s?.images?.length>0?s.images.sort((a,h)=>a.photo_id-h.photo_id).map(a=>`/markaz_alkarouz/public/storage/${a.photo}`):["/markaz_alkarouz/public/imgs/shopping.webp"],U=()=>{if(O)return;const a=s.colors?.find(N=>N.color===x),h=s.sizes?.find(N=>N.size===i);if(!x||!i){g("Please select color and size before adding to cart.");return}P.post(route("cart.add"),{product_id:s.product_id,quantity:o,color_id:a?.color_id||null,size_id:h?.size_id||null},{preserveScroll:!0,onSuccess:()=>{g(`"${s.pr_name}" has been added to your cart!`),B(!0),setTimeout(()=>g(""),3e3)}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 p-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[q?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>T(!0),children:"Add Photo"}),e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>_({show:!0,type:"material"}),children:"Add Material"}),e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>_({show:!0,type:"color"}),children:"Add Color"}),e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>_({show:!0,type:"size"}),children:"Add Size"})]}):null,M.show&&e.jsx(je,{type:M.type,productId:s.product_id,onClose:()=>_({show:!1,type:""}),onAdded:()=>window.location.reload()}),A&&e.jsx(ie,{product:s,onClose:()=>T(!1),onUploaded:()=>window.location.reload()}),e.jsx("div",{className:"w-full",children:e.jsx("img",{src:E[r],alt:s?.title,className:"rounded w-full object-cover"})}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:E.map((a,h)=>e.jsx("button",{className:`w-12 h-12 rounded border-2 overflow-hidden ${r===h?"border-blue-500":"border-gray-300"}`,onClick:()=>n(h),children:e.jsx("img",{src:a,alt:`thumb-${h}`,className:"w-full h-full object-cover"})},h))})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-[#12263f]",children:s?.pr_name}),e.jsx("hr",{className:"border-gray-300"}),e.jsxs("div",{className:"flex gap-1 items-baseline",children:[e.jsx("span",{className:"font-bold",children:"EGP"}),e.jsx("span",{className:"text-xl font-bold",children:Math.floor(Number(s?.pr_price||0))}),e.jsxs("span",{className:"text-sm",children:[".",String(s?.price||"0.00").split(".")[1]||"00"]})]}),s?.brand&&e.jsx("div",{className:"text-gray-700",children:e.jsx("h6",{className:"font-bold",children:s.brand})}),s?.pr_description&&e.jsx("div",{className:"text-gray-600",children:e.jsx("p",{children:s.pr_description})}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-start",children:[e.jsx("strong",{children:"Materials:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.materials?.map((a,h)=>e.jsx("span",{className:`px-2 py-1 rounded cursor-pointer transition ${j===a.material_name?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>u(a.material_name),children:a.material_name},a.material_id))})]}),e.jsx("div",{className:"flex flex-col gap-4",children:I&&(O?e.jsx("div",{className:"alert alert-info mt-2 text-center cursor-text p-3 bg-blue-100 border border-blue-400 rounded",children:"Already in cart"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>m(a=>Math.max(1,a-1)),children:"-"}),e.jsx("span",{className:"px-4 py-2 border border-gray-300 rounded text-center min-w-12",children:o}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>m(a=>a+1),children:"+"})]}),e.jsx("button",{className:"btn btn-success w-full",onClick:U,children:"Add to Cart"})]}))})]}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-lg block mb-3",children:"Discover the Colors:"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:s.colors?.map(a=>e.jsx("button",{className:`w-12 h-12 rounded-full border-4 transition ${x===a.color?"border-gray-800":"border-gray-300"}`,onClick:()=>y(a.color),style:{backgroundColor:a.color},title:a.color},a.color_id))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-lg block mb-3",children:"Discover the Sizes:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.sizes?.map(a=>e.jsx("button",{className:`px-3 py-2 rounded border-2 transition font-semibold ${i===a.size?"bg-blue-500 text-white border-blue-500":"border-gray-300 text-gray-700"}`,onClick:()=>p(a.size),children:a.size},a.size_id))})]})]})]}),e.jsx(Q,{message:D,onClose:()=>g("")})]})}$.propTypes={product:te.object.isRequired};const Pe=()=>{const{product:s,relatedProducts:d}=k().props,[c,t]=l.useState(!1),[r,n]=l.useState(!1),[o,m]=l.useState(null),i=u=>{o&&P.put(route("items.update",o.product_id),{name:u.name,brand:u.brand,description:u.description,price:u.price},{preserveScroll:!0,onSuccess:()=>{t(!1),m(null)}})},p=()=>{o&&P.delete(route("items.destroy",o.product_id),{preserveScroll:!0,onSuccess:()=>{n(!1),m(null)}})},{auth:x}=k().props,j=x.user?.user_type==="manager";return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"مركز وسائل الإيضاح"}),e.jsx(V,{page_name:"categories"}),e.jsxs(G,{children:[j?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex gap-2 mb-4 mt-4",children:[e.jsx("button",{className:"btn btn-primary",onClick:u=>{u.stopPropagation(),m(s),t(!0)},children:"Edit Product"}),e.jsx("button",{className:"btn btn-danger",onClick:u=>{u.stopPropagation(),m(s),n(!0)},children:"Delete Product"})]})}):null,e.jsx($,{product:s}),e.jsx(Y,{category_name:"You might also like",products:d,onEdit:i,onDelete:p}),c&&o&&e.jsx(J,{currentItem:o,onClose:()=>t(!1),onConfirm:i}),r&&o&&e.jsx(K,{itemName:o.pr_name,onClose:()=>n(!1),onConfirm:p})]})]})};export{Pe as default};
