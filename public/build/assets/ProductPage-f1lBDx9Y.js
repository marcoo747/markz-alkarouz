import{g as $,r as n,j as e,d as W,b as C,a as k,H as B}from"./app-StHp4lGL.js";import{N as H}from"./NavBar-BZTDjxhM.js";import{I as L}from"./Item-pack-QMVWj7ds.js";import{C as V}from"./Container-BH8gv93r.js";import{s as y}from"./index-ikzcNs2d.js";import{T as Y}from"./TopAlert-BSHftokx.js";import{E as G,D as Q}from"./DeleteItemModal-DzDc3RS5.js";import"./index-BMNUxnAA.js";/* empty css                      */var v={exports:{}},S,E;function J(){if(E)return S;E=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return S=s,S}var _,R;function K(){if(R)return _;R=1;var s=J();function c(){}function i(){}return i.resetWarningCache=c,_=function(){function t(o,p,d,m,x,g){if(g!==s){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}t.isRequired=t;function r(){return t}var l={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:i,resetWarningCache:c};return l.PropTypes=l,l},_}var q;function X(){return q||(q=1,v.exports=K()()),v.exports}var Z=X();const ee=$(Z),se=({product:s,onClose:c,onUploaded:i})=>{const[t,r]=n.useState(null),[l,o]=n.useState(!1),p=async d=>{if(d.preventDefault(),!t)return alert("Please select a photo!");const m=new FormData;m.append("photo",t),m.append("product_id",s.product_id),m.append("_token",document.querySelector('meta[name="csrf-token"]').content);try{o(!0),await W.post(y("products.upload_image"),m,{headers:{"Content-Type":"multipart/form-data"}}),o(!1),i?.(),c()}catch(x){o(!1),console.error(x),alert("Upload failed!")}};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content green-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Upload Photo"}),e.jsx("button",{className:"close-btn fs-2",onClick:c,children:"×"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:p,children:[e.jsxs("label",{className:"upload-btn",children:[t?t.name:"Choose Photo",e.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:d=>r(d.target.files[0]),required:!0})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"submit",className:"btn btn-success",disabled:l,children:l?"Uploading...":"Upload"}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:c,disabled:l,children:"Close"})]})]})}),e.jsx("style",{children:`
          .green-modal { width: 420px; background: #f0fff4; border-radius: 14px; box-shadow: 0 20px 40px rgba(0,128,0,0.2); animation: scaleIn 0.2s ease; }
          .green-modal .modal-header { background: linear-gradient(135deg, #28a745, #218838); color: white; padding: 16px 20px; border-radius: 14px 14px 0 0; display:flex; justify-content:space-between; align-items:center; }
          .close-btn { background:transparent; border:none; color:white; font-size:22px; cursor:pointer; }
          .modal-body { padding:20px; }
          .upload-btn { background-color:#28a745; color:white; padding:8px 14px; border-radius:8px; cursor:pointer; font-weight:500; display:inline-block; }
          .modal-footer { padding:16px 0 0; display:flex; justify-content:flex-end; gap:10px; }
          @keyframes scaleIn { from { transform:scale(0.9); opacity:0; } to { transform:scale(1); opacity:1; } }
        `})]})})},te=({type:s,productId:c,onClose:i})=>{const[t,r]=n.useState(s==="color"?"#000000":""),l={material:y("products.add-material"),color:y("products.add-color"),size:y("products.add-size")};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content green-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:["Add ",s.charAt(0).toUpperCase()+s.slice(1)]}),e.jsx("button",{className:"close-btn fs-2",onClick:i,children:"×"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{action:l[s],method:"POST",encType:"multipart/form-data",children:[e.jsx("input",{type:"hidden",name:"_token",value:document.querySelector('meta[name="csrf-token"]').content}),e.jsx("input",{type:"hidden",name:"product_id",value:c}),s==="color"?e.jsx("input",{type:"color",name:"value",value:t,onChange:o=>r(o.target.value),style:{width:"100%",height:"50px",border:"none",marginBottom:"16px",cursor:"pointer"},required:!0}):e.jsx("input",{type:"text",name:"value",value:t,placeholder:`Enter ${s}`,onChange:o=>r(o.target.value),required:!0}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"submit",className:"btn btn-success",children:"Add"}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,children:"Close"})]})]})}),e.jsx("style",{children:`
          .green-modal {
            width: 420px;
            background: #f0fff4;
            border-radius: 14px;
            box-shadow: 0 20px 40px rgba(0,128,0,0.2);
            animation: scaleIn 0.2s ease;
          }
          .green-modal .modal-header {
            background: linear-gradient(135deg, #28a745, #218838);
            color: white;
            padding: 16px 20px;
            border-radius: 14px 14px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
          }
          .close-btn { background: transparent; border: none; color: white; font-size: 22px; cursor: pointer; }
          .modal-body { padding: 20px; }
          .modal-body input { width: 100%; margin-top: 6px; padding: 10px 12px; border-radius: 8px; border: 1px solid #ced4da; }
          .modal-body input:focus { outline: none; border-color: #28a745; }
          .modal-footer { padding: 16px 0 0; display: flex; justify-content: flex-end; gap: 10px; }
          @keyframes scaleIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        `})]})})};function A({product:s}){const{auth:c,flash:i,cartItems:t=[]}=C().props||{},[r,l]=n.useState(0),[o,p]=n.useState(1),[d,m]=n.useState(""),[x,g]=n.useState(""),[b,u]=n.useState(""),[O,w]=n.useState(!1),[P,j]=n.useState({show:!1,type:""}),T=c.user,D=T?.user_type==="manager",[F,f]=n.useState(""),[I,z]=n.useState(!1);n.useEffect(()=>{t?.includes(s.product_id)&&z(!0)},[t,s.product_id]),n.useEffect(()=>{i?.success&&f(i.success)},[i]);const M=s?.images?.length>0?s.images.sort((a,h)=>a.photo_id-h.photo_id).map(a=>`/markaz_alkarouz/public/storage/${a.photo}`):["/markaz_alkarouz/public/imgs/shopping.webp"],U=()=>{if(I)return;const a=s.colors?.find(N=>N.color===x),h=s.sizes?.find(N=>N.size===d);if(!x||!d){f("Please select color and size before adding to cart.");return}k.post(route("cart.add"),{product_id:s.product_id,quantity:o,color_id:a?.color_id||null,size_id:h?.size_id||null},{preserveScroll:!0,onSuccess:()=>{f(`"${s.pr_name}" has been added to your cart!`),z(!0),setTimeout(()=>f(""),3e3)}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"product-page",children:[e.jsxs("div",{className:"product-gallery",children:[D?e.jsxs("div",{className:"add-photo-section",children:[e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>w(!0),children:"Add Photo"}),e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>j({show:!0,type:"material"}),children:"Add Material"}),e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>j({show:!0,type:"color"}),children:"Add Color"}),e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>j({show:!0,type:"size"}),children:"Add Size"})]}):null,P.show&&e.jsx(te,{type:P.type,productId:s.product_id,onClose:()=>j({show:!1,type:""}),onAdded:()=>window.location.reload()}),O&&e.jsx(se,{product:s,onClose:()=>w(!1),onUploaded:()=>window.location.reload()}),e.jsx("div",{className:"main-image",children:e.jsx("img",{src:M[r],alt:s?.title,className:"rounded"})}),e.jsx("div",{className:"thumbs",children:M.map((a,h)=>e.jsx("button",{className:`thumb-btn ${r===h?"active":""}`,onClick:()=>l(h),children:e.jsx("img",{src:a,alt:`thumb-${h}`})},h))})]}),e.jsxs("div",{className:"product-details",children:[e.jsx("h1",{className:"product-title",children:s?.pr_name}),e.jsx("hr",{className:"divider"}),e.jsxs("div",{className:"product-price-section",children:[e.jsx("span",{className:"currency",children:"EGP"}),e.jsx("span",{children:Math.floor(Number(s?.pr_price||0))}),e.jsx("span",{className:"superscript",children:String(s?.price||"0.00").split(".")[1]||"00"})]}),s?.brand&&e.jsx("div",{className:"product-description",children:e.jsx("h6",{children:s.brand})}),s?.pr_description&&e.jsx("div",{className:"product-description",children:e.jsx("p",{children:s.pr_description})}),e.jsxs("div",{className:"materials",children:[e.jsx("strong",{children:"Materials:"})," ",s.materials?.map((a,h)=>e.jsxs("span",{className:`material-option ${b===a.material_name?"selected":""}`,onClick:()=>u(a.material_name),children:[a.material_name,h<s.materials.length-1?", ":""]},a.material_id))]}),e.jsx("div",{className:"product-actions",children:T&&(I?e.jsx("div",{className:"alert alert-info mt-2 text-center cursor-text",children:"Already in cart"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"quantity-selector",children:[e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>p(a=>Math.max(1,a-1)),children:"-"}),e.jsx("span",{className:"qty-display-box",children:o}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>p(a=>a+1),children:"+"})]}),e.jsx("button",{className:"btn btn-success w-100",onClick:U,children:"Add to Cart"})]}))})]}),e.jsxs("div",{className:"product-info-box",children:[e.jsx("span",{className:"section-title",children:"Discover the Colors:"}),e.jsx("div",{className:"colors",children:s.colors?.map(a=>e.jsx("span",{className:`color-circle ${x===a.color?"selected":""}`,onClick:()=>g(a.color),style:{backgroundColor:a.color}},a.color_id))}),e.jsxs("div",{className:"sizes",children:[e.jsx("span",{className:"section-title",children:"Discover the Sizes:"}),e.jsx("div",{className:"size-options",children:s.sizes?.map(a=>e.jsx("span",{className:`size-option ${d===a.size?"selected":""}`,onClick:()=>m(a.size),children:a.size},a.size_id))})]})]})]}),e.jsx(Y,{message:F,onClose:()=>f("")})]})}A.propTypes={product:ee.object.isRequired};const me=()=>{const{product:s,relatedProducts:c}=C().props,[i,t]=n.useState(!1),[r,l]=n.useState(!1),[o,p]=n.useState(null),d=u=>{o&&k.put(route("items.update",o.product_id),{name:u.name,brand:u.brand,description:u.description,price:u.price},{preserveScroll:!0,onSuccess:()=>{t(!1),p(null)}})},m=()=>{o&&k.delete(route("items.destroy",o.product_id),{preserveScroll:!0,onSuccess:()=>{l(!1),p(null)}})},{auth:x}=C().props,b=x.user?.user_type==="manager";return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"مركز وسائل الإيضاح"}),e.jsx(H,{page_name:"categories"}),e.jsxs(V,{children:[b?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"action-btns",children:[e.jsx("button",{className:"btn btn-primary",onClick:u=>{u.stopPropagation(),p(s),t(!0)},children:"Edit Product"}),e.jsx("button",{className:"btn btn-danger",onClick:u=>{u.stopPropagation(),p(s),l(!0)},children:"Delete Product"})]})}):null,e.jsx(A,{product:s}),e.jsx(L,{category_name:"You might also like",products:c,onEdit:d,onDelete:m}),i&&o&&e.jsx(G,{currentItem:o,onClose:()=>t(!1),onConfirm:d}),r&&o&&e.jsx(Q,{itemName:o.pr_name,onClose:()=>l(!1),onConfirm:m})]})]})};export{me as default};
