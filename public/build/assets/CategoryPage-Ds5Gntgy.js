import{b as k,r as a,j as e,L as M,a as C,H as E}from"./app-StHp4lGL.js";import{T as P}from"./TopAlert-BSHftokx.js";import{n as T}from"./index-BMNUxnAA.js";import{C as z}from"./Container-BH8gv93r.js";import{N as q}from"./NavBar-BZTDjxhM.js";/* empty css                      */import{E as B,D as F}from"./DeleteItemModal-DzDc3RS5.js";const L=({id:r,title:i,brand:u,description:b,image:l,price:h,color_id:d,color:p,size_id:c,size:t,onEdit:o,onDelete:x,children:n})=>{const{auth:N,flash:g,cartItems:j=[]}=k().props||{},y=N?.user,I=y?.user_type==="manager",[v,s]=a.useState(""),[w,S]=a.useState(!1),[f,_]=a.useState(1);a.useEffect(()=>{j?.includes(r)&&S(!0)},[j,r]),a.useEffect(()=>{g?.success&&s(g.success)},[g]);const A=m=>{m.stopPropagation(),C.post(route("cart.add"),{product_id:r,color_id:d||null,size_id:c||null,quantity:f},{preserveScroll:!0,onSuccess:()=>{S(!0),s(`"${i}" added to cart!`),setTimeout(()=>s(""),3e3)}})};return e.jsxs(e.Fragment,{children:[e.jsxs("article",{className:"card product-card h-100","aria-label":i,style:{cursor:"pointer"},children:[e.jsx(M,{href:route("items.show",r),className:"text-decoration-none text-dark flex-grow-1",children:l&&e.jsx("img",{src:l,alt:i,loading:"lazy",className:"product-image",onClick:m=>m.stopPropagation()})}),e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsxs(M,{href:route("items.show",r),className:"text-decoration-none text-dark flex-grow-1",children:[e.jsx("h3",{children:i}),e.jsx("h6",{children:u}),e.jsx("p",{className:"text-muted",children:b}),e.jsxs("p",{className:"price fw-bold mt-auto",children:["EGP ",h]}),p&&e.jsxs("p",{className:"d-flex align-items-center",children:[e.jsx("span",{style:{display:"inline-block",width:16,height:16,borderRadius:"50%",backgroundColor:p,marginLeft:8,border:"1px solid #ccc"}}),e.jsxs("span",{className:"ms-2",children:[T(p).basic[0].name,", etc..."]})]}),t&&e.jsxs("p",{children:[t,", etc..."]})]}),y&&(w?e.jsx("div",{className:"alert alert-info mt-2 text-center cursor-text",children:"Already in cart"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",onClick:m=>m.stopPropagation(),children:[e.jsx("label",{className:"form-label fw-bold",children:"Quantity"}),e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2 qty-controls",children:[e.jsx("button",{type:"button",className:"btn btn-outline-secondary qty-btn",onClick:()=>_(Math.max(1,f-1)),disabled:f<=1,children:"–"}),e.jsx("span",{className:"qty-display border rounded bg-light fw-bold",children:f}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary qty-btn",onClick:()=>_(f+1),children:"+"})]})]}),e.jsx("button",{className:"btn btn-success w-100",onClick:A,children:"Add to Cart"})]})),I&&(o||x)&&e.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},onClick:m=>m.stopPropagation(),children:[o&&e.jsx("button",{className:"btn btn-primary flex-grow-1",onClick:o,children:"Edit"}),x&&e.jsx("button",{className:"btn btn-danger flex-grow-1",onClick:x,children:"Delete"})]}),n&&e.jsx("div",{className:"mt-2",onClick:m=>m.stopPropagation(),children:n})]})]}),e.jsx(P,{message:v,onClose:()=>s("")})]})},D=({onClose:r,onConfirm:i})=>{const[u,b]=a.useState(""),[l,h]=a.useState(""),[d,p]=a.useState(""),[c,t]=a.useState(""),o=()=>{if(!u||!l||!d||!c)return alert("All fields are required!");i({name:u,brand:l,description:d,price:c}),x()},x=()=>{b(""),h(""),p(""),t("")};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content add-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Add Item"}),e.jsx("button",{className:"close-btn fs-2",onClick:r,children:"×"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("label",{children:"Item Name"}),e.jsx("input",{value:u,onChange:n=>b(n.target.value)}),e.jsx("label",{children:"Item Brand"}),e.jsx("input",{value:l,onChange:n=>h(n.target.value)}),e.jsx("label",{children:"Description"}),e.jsx("input",{value:d,onChange:n=>p(n.target.value)}),e.jsx("label",{children:"Price"}),e.jsx("input",{type:"number",min:"0",value:c,onChange:n=>t(n.target.value)})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-success",onClick:o,children:"Add Item"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:r,children:"Cancel"})]}),e.jsx("style",{children:`
          .add-modal {margin-top: 5.5%; width:420px; background:#e6f4ea; border-radius:14px; box-shadow:0 20px 40px rgba(46,204,113,0.2); animation: scaleIn 0.2s ease; }
          .add-modal .modal-header { background:linear-gradient(135deg,#2ecc71,#27ae60); color:white; padding:16px 20px; border-radius:14px 14px 0 0; display:flex; justify-content:space-between; align-items:center; }
          .close-btn { background:transparent; border:none; color:white; font-size:22px; cursor:pointer; }
          .modal-body { padding:20px; }
          .modal-body label { font-weight:600; margin-top:12px; display:block; }
          .modal-body input, .modal-body textarea { width:100%; margin-top:6px; padding:10px 12px; border-radius:8px; border:1px solid #ced4da; }
          .modal-body input:focus, .modal-body textarea:focus { outline:none; border-color:#27ae60; }
          .file-upload { margin-top:16px; display:flex; align-items:center; gap:10px; }
          .upload-btn { background-color:#27ae60; color:white; padding:8px 14px; border-radius:8px; cursor:pointer; font-weight:500; }
          .file-name { font-size:0.9rem; color:#495057; }
          .modal-footer { padding:16px 20px; display:flex; justify-content:flex-end; gap:10px; border-top:1px solid #dee2e6; }
          @keyframes scaleIn { from { transform:scale(0.9); opacity:0; } to { transform:scale(1); opacity:1; } }
        `})]})})},K=()=>{const r=k(),i=r.props.category||{},u=r.props.products||[],[b,l]=a.useState(!1),[h,d]=a.useState(!1),[p,c]=a.useState(!1),[t,o]=a.useState(null),x=s=>{C.post(route("categories.items.store",i.category_id),{name:s.name,brand:s.brand,description:s.description,price:s.price},{preserveScroll:!0,onSuccess:()=>l(!1),onError:w=>console.log(w)})},n=s=>{t&&C.put(route("items.update",t.product_id),{name:s.name,brand:s.brand,description:s.description,price:s.price},{preserveScroll:!0,onSuccess:()=>{d(!1),o(null)}})},N=()=>{t&&C.delete(route("items.destroy",{item:t.id}),{preserveScroll:!0,onSuccess:()=>{c(!1),o(null)}})},g=()=>{d(!1),o(null)},j=()=>{c(!1),o(null)},{auth:y}=k().props,v=y.user?.user_type==="manager";return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"مركز وسائل الإيضاح"}),e.jsx(q,{page_name:"categories"}),e.jsxs(z,{children:[e.jsxs("h2",{style:{marginTop:24},children:[i.category_name?.toUpperCase()," Products"]}),v?e.jsx("div",{className:"action-btns",style:{marginTop:"16px",marginBottom:"32px",display:"flex",gap:"10px"},children:e.jsx("button",{className:"btn btn-success",onClick:()=>l(!0),children:"Add Item"})}):null,e.jsx("div",{className:"row",children:u.map(s=>e.jsx("div",{className:"col-6 col-md-4 col-lg-3 mb-4",style:{marginTop:24},children:e.jsx(L,{id:s.id,title:s.title,brand:s.brand,description:s.description,price:s.price,color:s.color,color_id:s.color_id,size:s.size,size_id:s.size_id,image:s.image,onEdit:()=>{o(s),d(!0)},onDelete:()=>{o(s),c(!0)}},s.id)},s.id))}),b&&e.jsx(D,{onClose:()=>l(!1),onConfirm:x}),h&&t&&e.jsx(B,{currentItem:t,onClose:g,onConfirm:n}),p&&t&&e.jsx(F,{itemName:t.pr_name,onClose:j,onConfirm:N})]})]})};export{K as default};
